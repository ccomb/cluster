#cloud-config

hostname: edjo
ssh_authorized_keys:
    - ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAIEAt5C+jF0KRK7VUBrfUjh4KDN6I2WnHMpDIEMXP0hw+1xyhSfp3fDjIeiUIEEV4TjjrrgbT9vXWB99Wb/ktUZZX5V27RKptnX5QWyjEzsH2ITaylyYY54IHvPRf4XBhXOmRgl9255sFZ7EIa++v1xE3bkTGB+EIzUNaRL9ykZ4/UE= ccomb@portouf

write_files:
    -
        path: /etc/resolv.conf
        permissions: '0644'
        owner: root
        content: "nameserver 62.210.16.6\nnameserver 62.210.16.7\n"
    -
        path: /etc/environment
        permissions: '0644'
        owner: root
        content: "COREOS_PUBLIC_IPV4=163.172.101.142\nCOREOS_PRIVATE_IPV4=10.91.210.58\n"
users:
    -
        name: ccomb
        passwd: "!"
        groups:
            - sudo
            - docker
        ssh-authorized-keys:
            - ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAIEAt5C+jF0KRK7VUBrfUjh4KDN6I2WnHMpDIEMXP0hw+1xyhSfp3fDjIeiUIEEV4TjjrrgbT9vXWB99Wb/ktUZZX5V27RKptnX5QWyjEzsH2ITaylyYY54IHvPRf4XBhXOmRgl9255sFZ7EIa++v1xE3bkTGB+EIzUNaRL9ykZ4/UE= ccomb@portouf
coreos:
    units:
        -
            name: 00-eno1.network
            runtime: true
            content: "[Match]\nName=enp1s0f0\n\n[Network]\nDHCP=yes\n\n[DHCP]\nUseMTU=false\n"
        -
            name: 00-eno2.network
            runtime: true
            content: "[Match]\nName=enp1s0f1\n\n[Network]\nDHCP=yes\n\n[DHCP]\nUseMTU=false\n"
        - name: custom-mtu.service
          command: start
          content: |
            [Unit]
            Requires=enp1s0f1.network
            [Service]
            Type=oneshot
            RemainAfterExit=yes
            ExecStart=/usr/bin/ip link set dev enp1s0f1 mtu 9000
        -
            name: var-lib-docker-volumes.mount
            enable: true
            content: |
              [Unit]
              Before=docker.service
              [Install]
              RequiredBy=docker.service
              [Mount]
              What=/dev/sdb
              Where=/var/lib/docker/volumes
              Type=btrfs
              Options=discard,ssd,subvol=volumes
        -
            name: var-lib-docker-snapshots.mount
            enable: true
            content: |
              [Unit]
              Before=docker.service
              [Install]
              RequiredBy=docker.service
              [Mount]
              What=/dev/sdb
              Where=/var/lib/docker/snapshots
              Type=btrfs
              Options=discard,ssd,subvol=snapshots

